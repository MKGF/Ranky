name: Git Workflow Pipeline

on:
  push:
    branches:
      - develop
      - master
      - AWS202405

jobs:
  push-to-master:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Configure git_config
        run: |
          git config --global user.email "actions@github.com"
          git config --global user.name "GitHub Actions"

      - name: Merge develop to master
        run: |
          git checkout master
          git merge develop
          git push origin master

      - name: Merge branch to AWS202405
        run: |
          git checkout AWS202405
          git merge develop
          git push origin AWS202405

      # - name: Check if tag exists
      #   id: check_tag
      #   run: |
      #     if [[ $(git tag --points-at ea465bdb047159429605433d4249200eab505b9d) ]]; then
      #       echo "TAG_EXISTS=true" >> $GITHUB_ENV
      #     else
      #       echo "TAG_EXISTS=false" >> $GITHUB_ENV
      #     fi

      # - name: Set Tag Output
      #   if: env.TAG_EXISTS == 'true'
      #   run: echo "Tag exists"

      # - name: Push version to master
      #   if: env.TAG_EXISTS == 'true'
      #   run: |
      #     git checkout master
      #     git merge ${{ steps.check_tag.outputs.TAG_EXISTS }}
      #     git push origin master

#     - name: Configure AWS credentials
#       uses: aws-actions/configure-aws-credentials@v1
#       with:
#         aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#         aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#         aws-region: eu-west-3

#     - name: Create Secrets
#       uses: 1arp/create-a-file-action@0.4.5
#       with:
#         path: 'src/main/resources'
#         is AbsolutePath: false
#         file: 'application-secret.properties'
#         content: |
#           riot.api.key=${{ secrets.RIOT_API_KEY }}
#           disc.api.key=${{ secrets.DISCORD_API_KEY }}

#     - name: Set up JDK 17
#       uses: actions/setup-java@v3
#       with:
#         java-version: '17'
#         distribution: 'adopt'
#         cache: maven

#     - name: Build with Maven
#       run: mvn clean package -DskipTests